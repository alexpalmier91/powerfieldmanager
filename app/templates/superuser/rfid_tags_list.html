{# app/templates/superuser/rfid_tags_list.html #}
{% extends "_layouts/app.html" %}

{% block title %}Tags RFID{% endblock %}
{% block breadcrumb %}Tags RFID{% endblock %}

{% block content %}
  <h1>Tags RFID</h1>

  <div class="card" style="margin-top:16px;">
    <form method="get"
          style="display:flex; gap:8px; flex-wrap:wrap; align-items:center;">
      <input type="text"
             name="q"
             placeholder="Recherche EPC / SKU"
             value="{{ q }}"
             style="padding:4px 8px; min-width:220px;">

      <select name="status_filter" style="padding:4px 8px;">
        <option value="">Tous les statuts</option>
        <option value="in_stock" {{ "selected" if status_filter=="in_stock" }}>En stock</option>
        <option value="loaded_on_display" {{ "selected" if status_filter=="loaded_on_display" }}>Sur présentoir</option>
        <option value="sold" {{ "selected" if status_filter=="sold" }}>Vendu</option>
        <option value="lost" {{ "selected" if status_filter=="lost" }}>Perdu</option>
      </select>

      <button type="submit" class="btn btn-primary">Filtrer</button>
    </form>
  </div>

  <div class="card" style="margin-top:16px;">
    {% if tags %}
      <table class="table">
        <thead>
          <tr>
            <th>ID</th>
            <th>EPC</th>
            <th>SKU</th>
            <th>ID produit</th>
            <th>Statut</th>
            <th>Dernière vue</th>
          </tr>
        </thead>
        <tbody>
          {% for tag in tags %}
            <tr>
              <td>
                <a href="/superuser/rfid-tags/{{ tag.id }}">
                  #{{ tag.id }}
                </a>
              </td>
              <td style="font-family:monospace; font-size:0.85rem;">
                {{ tag.epc }}
              </td>
              <td>{{ tag.sku or "-" }}</td>
              <td>{{ tag.product_id or "-" }}</td>
              <td>{{ tag.status.value }}</td>
              <td>{{ tag.last_seen_at or "-" }}</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>

      <div style="margin-top:8px; display:flex; gap:8px; align-items:center;">
        {% if page > 1 %}
          <a class="btn"
             href="?page={{ page-1 }}&q={{ q }}&status_filter={{ status_filter }}">
            ← Page précédente
          </a>
        {% endif %}

        <span>Page {{ page }} / {{ total_pages }}</span>

        {% if page < total_pages %}
          <a class="btn"
             href="?page={{ page+1 }}&q={{ q }}&status_filter={{ status_filter }}">
            Page suivante →
          </a>
        {% endif %}
      </div>
    {% else %}
      <p>Aucun tag RFID.</p>
    {% endif %}
  </div>
{% endblock %}
