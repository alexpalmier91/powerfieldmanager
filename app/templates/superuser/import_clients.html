{# app/templates/superuser/import_clients.html #}
{% extends "_layouts/app.html" %}

{% block head %}
  {{ super() }}
  <link rel="stylesheet" href="{{ url_for('static', path='/superuser/client_import.css') }}">
{% endblock %}

{% block content %}
<div class="container-fluid" id="superuser-import-clients-page">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h1 data-i18n="superuser.clients_import.title">
      Importation des clients
    </h1>
  </div>

  <div class="card mb-3">
    <div class="card-body">
      <form
        id="import-clients-form"
        enctype="multipart/form-data"
        class="row g-3 align-items-end"
      >
        <div class="col-md-6">
          <label
            for="clients-file"
            class="form-label"
            data-i18n="superuser.clients_import.file.label"
          >
            Fichier clients (Excel ou CSV)
          </label>
          <input
            type="file"
            class="form-control"
            id="clients-file"
            name="file"
            accept=".xlsx,.xls,.csv"
            required
          >
          <div class="form-text" data-i18n="superuser.clients_import.file.help">
            Colonnes prises en charge : code_client, company_name, first_name, last_name,
            address1, postcode, city, siret, email, phone, groupement, country,
            iban, bic, payment_terms, credit_limit, sepa_mandate_ref…
          </div>
        </div>

        <div class="col-md-3">
          <label
            for="clients-labo-id"
            class="form-label"
            data-i18n="superuser.clients_import.labo.label"
          >
            Labo (pour code client)
          </label>
          <input
            type="number"
            class="form-control"
            id="clients-labo-id"
            name="labo_id"
            value="1"
            min="1"
          >
          <div class="form-text" data-i18n="superuser.clients_import.labo.help">
            Optionnel : si un code client labo est présent dans le fichier,
            il sera lié à ce labo.
          </div>
        </div>

        <div class="col-md-3 text-md-end">
          <button
            type="submit"
            class="btn btn-primary mt-3 mt-md-0"
            data-i18n="superuser.clients_import.submit"
          >
            Importer
          </button>
        </div>
      </form>
    </div>
  </div>

  <div class="card">
    <div class="card-header">
      <span data-i18n="superuser.clients_import.result.title">
        Résultat de l’import
      </span>
    </div>
    <div class="card-body">
      <div
        id="import-clients-status"
        class="mb-2 text-muted"
        data-i18n="superuser.clients_import.result.empty"
      >
        En attente d’un fichier…
      </div>

      <pre
        id="import-clients-result"
        class="small mb-0"
        style="white-space: pre-wrap;"
      ></pre>
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
  {{ super() }}
  <script src="/static/superuser/pages/import_clients.js"></script>
{% endblock %}
